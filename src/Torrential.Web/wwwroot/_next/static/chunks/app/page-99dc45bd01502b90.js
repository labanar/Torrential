(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6220:function(e,t,n){Promise.resolve().then(n.bind(n,2937))},2937:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return F}});var r=n(3827),o=n(6632),s=n(3518),l=n(1534),a=n(9174),i=n(4569),c=n(8838),d=n(209),u=n(4873),h=n(9228),p=n(129),f=n(653),x=n(2250),g=n(2372),m=n(1957),j=n(9623),y=n(4454),_=n.n(y),v=n(4907),S=n(7535),b=n(4090);let R=(0,b.forwardRef)((e,t)=>{let{onFileChange:n,accept:o}=e;(0,b.useImperativeHandle)(t,()=>({openFilePicker(){null!=s&&null!==s.current&&s.current.click()}}));let s=(0,b.useRef)(null);return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("input",{type:"file",accept:o,hidden:!0,style:{display:"none"},ref:s,onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t.item(0);null!=r&&n(r)}})})});R.displayName="FileUpload";var C=n(828);let k=C.I0.withTypes();C.v9.withTypes();var w=n(9053),B=n(2794),N=n(4419);let z=(0,N.P1)(e=>e.torrents,e=>e.peers,(e,t)=>Object.keys(e).map(n=>({...e[n],peers:t[n]||[]}))),D=e=>(0,N.P1)(e=>e.torrents,t=>e.reduce((e,n)=>(t[n]&&(e[n]=t[n]),e),{}));var E=n(6480),I=n.n(E);function F(){let e=k(),t=(0,C.v9)(z),[n,s]=(0,b.useState)([]),l=(0,b.useMemo)(()=>(0,r.jsx)(T,{selectedTorrents:n,setSelectedTorrents:s}),[n]);(0,b.useEffect)(()=>{console.log("TORRENTS CHANGED")},[t]);let a=(e,t)=>{t.ctrlKey||t.metaKey?n.includes(e)?s(n.filter(t=>t!==e)):s([...n,e]):n.includes(e)?s([]):s([e])},i=e=>n.includes(e),c=(0,b.useCallback)(async()=>{try{let t=await fetch("".concat("","/torrents"));if(!t.ok){console.log("Error fetching torrents");return}let n=await t.json();if(n.data){let{data:t}=n,r=t.reduce((e,t)=>{let n={name:t.name,infoHash:t.infoHash,progress:t.progress,uploadRate:t.uploadRate,downloadRate:t.downloadRate,sizeInBytes:t.totalSizeBytes,status:t.status,bytesUploaded:t.bytesUploaded,bytesDownloaded:t.bytesDownloaded};return e[t.infoHash]=n,e},{});e((0,w._b)(r)),t.forEach(t=>{let n=t.peers.reduce((e,n)=>{let r={infoHash:t.infoHash,ip:n.ipAddress,port:n.port,peerId:n.peerId,isSeed:n.isSeed};return e.push(r),e},[]);e((0,B.Z8)({infoHash:t.infoHash,peers:n}))})}}catch(e){console.log("error fetching torrents")}},[e]);return(0,b.useEffect)(()=>{c()},[c]),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:_().root,children:[l,(0,r.jsx)("div",{className:_().torrentDivider,children:(0,r.jsx)(o.i,{orientation:"horizontal"})}),(0,r.jsx)("div",{className:_().torrentList,children:t.map(e=>{var t,n,o,s,l,c,d,u;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(G,{onSelect:a,isSelected:i(e.infoHash),uploadRate:e.uploadRate,downloadRate:e.downloadRate,status:e.status,progress:null!==(o=e.progress)&&void 0!==o?o:0,infoHash:null!==(s=e.infoHash)&&void 0!==s?s:"",seeders:null!==(l=null===(t=e.peers)||void 0===t?void 0:t.reduce((e,t)=>t.isSeed?e+1:e,0))&&void 0!==l?l:0,leechers:null!==(c=null===(n=e.peers)||void 0===n?void 0:n.reduce((e,t)=>t.isSeed?e:e+1,0))&&void 0!==c?c:0,totalBytes:null!==(d=e.sizeInBytes)&&void 0!==d?d:0,title:null!==(u=e.name)&&void 0!==u?u:"???"},e.infoHash)})})})]})})}let T=e=>{let{selectedTorrents:t,setSelectedTorrents:n}=e,o=(0,b.useRef)(null),[i,c]=(0,b.useState)(!1),d=async e=>{let t=new FormData;t.append("file",e);try{let e=await fetch("".concat("","/torrents/add"),{method:"POST",body:t});if(!e.ok)throw Error("File upload failed");let n=await e.json();console.log("File uploaded successfully:",n)}catch(e){console.error("Error uploading file:",e)}},u=async e=>{try{await fetch("".concat("","/torrents/").concat(e,"/stop"),{method:"POST"})}catch(e){console.log(e),console.log("Error stopping torrent")}},h=async e=>{try{await fetch("".concat("","/torrents/").concat(e,"/start"),{method:"POST"})}catch(e){console.log(e),console.log("Error stopping torrent")}},p=async(e,t)=>{try{await fetch("".concat("","/torrents/").concat(e,"/delete"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({deleteFiles:t})})}catch(e){console.log(e),console.log("Error deleting torrent")}},f=async()=>{t.forEach(e=>{u(e)})},x=async()=>{t.forEach(e=>{h(e)})},g=async e=>{t.forEach(t=>{p(t,e)}),n([])},m=(0,b.useMemo)(()=>0===t.length,[t]);return(0,r.jsxs)("div",{className:_().actionBar,children:[(0,r.jsx)(R,{accept:".torrent",ref:o,onFileChange:e=>d(e)}),(0,r.jsx)(M,{open:i,infoHashes:t,onClose:()=>c(!1),onRemove:(e,t)=>g(t)}),(0,r.jsx)("div",{className:_().actionSearch,children:(0,r.jsx)(s.I,{variant:"filed",placeholder:"Filter",style:{maxWidth:"200px",justifySelf:"start"}})}),(0,r.jsxs)("div",{className:_().actionButtons,children:[(0,r.jsx)(l.u,{label:"Start",children:(0,r.jsx)(a.h,{isDisabled:m,onClick:()=>x(),colorScheme:"green","aria-label":"Start",icon:(0,r.jsx)(v.G,{icon:S.zc})})}),(0,r.jsx)(l.u,{label:"Stop",children:(0,r.jsx)(a.h,{onClick:()=>f(),isDisabled:m,colorScheme:"orange","aria-label":"Stop",icon:(0,r.jsx)(v.G,{icon:S.XQY})})}),(0,r.jsx)(l.u,{label:"Delete",children:(0,r.jsx)(a.h,{onClick:()=>c(!0),isDisabled:m,colorScheme:"red","aria-label":"Remove",icon:(0,r.jsx)(v.G,{icon:S.$aW})})}),(0,r.jsx)(l.u,{label:"Add Torrent",children:(0,r.jsx)(a.h,{colorScheme:"blue","aria-label":"Add",icon:(0,r.jsx)(v.G,{icon:S.r8p}),onClick:()=>{null!==o&&null!==o.current&&o.current.openFilePicker()}})})]}),(0,r.jsx)("div",{style:{flexGrow:1,flexShrink:1}})]})};function G(e){let{infoHash:t,title:n,progress:s,totalBytes:a,seeders:d,leechers:u,status:h,uploadRate:p,downloadRate:f,isSelected:x,onSelect:g}=e,m=(0,b.useMemo)(()=>"Stopped"===h||"Idle"===h?"orange":"Running"===h?"green":void 0,[h]);function j(e){let t=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];if(0===e)return"0 Byte";let n=Math.floor(Math.log(e)/Math.log(1024));return 0===n?e+" "+t[n]:(e/Math.pow(1024,n)).toFixed(2)+" "+t[n]}let y=(0,b.useMemo)(()=>x?I()(_().torrentContainer,_().torrentContainerSelected):I()(_().torrentContainer),[x]);return(0,r.jsxs)("div",{className:y,onClick:e=>g(t,e),children:[(0,r.jsxs)("div",{className:_().torrent,children:[(0,r.jsxs)("div",{className:_().torrentIcon,children:["Running"===h&&s<1&&(0,r.jsx)(v.G,{icon:S.OR$,size:"xl",style:{paddingRight:"0.8em",paddingLeft:"0.4em",color:m}}),"Running"===h&&s>=1&&(0,r.jsx)(v.G,{icon:S.nIL,size:"xl",style:{paddingRight:"0.8em",paddingLeft:"0.4em",color:m}}),("Stopped"===h||"Idle"===h)&&(0,r.jsx)(v.G,{icon:S.XQY,size:"xl",style:{paddingRight:"0.8em",paddingLeft:"0.4em",color:m}})]}),(0,r.jsxs)("div",{className:_().torrentInfo,children:[(0,r.jsx)(i.x,{className:_().title,fontSize:"md",noOfLines:1,children:n}),(0,r.jsx)(i.x,{className:_().progress,fontSize:"xs",children:"".concat(j(a*s)," of ").concat(j(a)," (").concat((100*s).toFixed(1),"%)")}),(0,r.jsx)(c.E,{value:100*s,colorScheme:m,color:"#1a1a1a",height:"1em"}),(0,r.jsxs)(i.x,{className:_().progressDetails,fontSize:"xs",children:[(0,r.jsx)(l.u,{label:"".concat(d+u," peers"),children:(0,r.jsxs)("span",{children:[(0,r.jsx)(v.G,{icon:S.NdV,size:"sm",style:{paddingRight:"0.3em"}}),"".concat(d+u)]})})," â€¢ ",(0,r.jsx)(l.u,{label:"".concat(d," seeders"),children:(0,r.jsxs)("span",{children:[(0,r.jsx)(v.G,{icon:S.YKZ,size:"sm",style:{paddingRight:"0.3em"}}),d]})}),(0,r.jsxs)("span",{children:[(0,r.jsx)(v.G,{icon:S.OR$,size:"sm",style:{paddingLeft:"1em",paddingRight:"0.3em"}}),j(f)+"/s"]}),(0,r.jsxs)("span",{children:[(0,r.jsx)(v.G,{icon:S.nIL,size:"sm",style:{paddingLeft:"0.5em",paddingRight:"0.3em"}}),j(p)+"/s"]})]})]},t)]}),(0,r.jsx)("div",{className:_().torrentDivider,children:(0,r.jsx)(o.i,{orientation:"horizontal"})})]})}function M(e){let{infoHashes:t,onClose:n,onRemove:o,open:s}=e,l=(0,b.useMemo)(()=>!t||t.length<=1?"Remove Torrent":"Remove Torrents",[t]),[a,c]=(0,b.useState)(!1),y=(0,C.v9)(D(t));return(0,r.jsxs)(d.u_,{isOpen:s,onClose:n,size:"lg",children:[(0,r.jsx)(u.Z,{}),(0,r.jsxs)(h.h,{children:[(0,r.jsx)(p.x,{children:l}),(0,r.jsx)(f.o,{}),(0,r.jsxs)(x.f,{className:_().deleteModalBody,children:[(0,r.jsx)(i.x,{children:"Are you sure you want remove: "}),(0,r.jsx)("ul",{style:{paddingLeft:"2em"},children:t.map(e=>(0,r.jsx)("li",{children:(0,r.jsx)(i.x,{children:y[e].name})},e))}),(0,r.jsx)(g.X,{className:_().deleteFilesCheckbox,defaultChecked:!1,onChange:e=>c(e.target.checked),children:"Delete Files on Disk"})]}),(0,r.jsxs)(m.m,{children:[(0,r.jsx)(j.z,{colorScheme:"red",mr:3,onClick:()=>{o(t,a),n()},children:"Remove"}),(0,r.jsx)(j.z,{onClick:n,children:"Close"})]})]})]})}},2794:function(e,t,n){"use strict";n.d(t,{EK:function(){return s},GG:function(){return a},X3:function(){return o},Z8:function(){return l}});let r=(0,n(8508).oM)({name:"peers",initialState:{},reducers:{addPeer(e,t){let{infoHash:n,peerId:r,ip:o,port:s,isSeed:l}=t.payload,a={infoHash:n,peerId:r,ip:o,port:s,isSeed:l};e[n]=e[n]?[...e[n],a]:[a]},removePeer(e,t){let{infoHash:n,peerId:r}=t.payload;e[n]=e[n].filter(e=>e.peerId!==r)},setPeers(e,t){let{infoHash:n,peers:r}=t.payload;e[n]=r},updatePeer(e,t){let{infoHash:n,peerId:r,update:o}=t.payload,s=e[n].findIndex(e=>e.peerId===r);-1!==s&&(e[n][s]={...e[n][s],...o})}}}),{addPeer:o,removePeer:s,setPeers:l,updatePeer:a}=r.actions;t.ZP=r.reducer},9053:function(e,t,n){"use strict";n.d(t,{BL:function(){return s},Zo:function(){return l},_b:function(){return o}});let r=(0,n(8508).oM)({name:"torrents",initialState:{},reducers:{setTorrents:(e,t)=>({...e,...t.payload}),updateTorrent(e,t){let{infoHash:n,update:r}=t.payload;e[n]={...e[n],...r}},removeTorrent(e,t){let{infoHash:n}=t.payload;delete e[n]}}}),{setTorrents:o,updateTorrent:s,removeTorrent:l}=r.actions;t.ZP=r.reducer},4454:function(e){e.exports={root:"page_root__AhT91",torrentList:"page_torrentList__ybm7r",torrentContainer:"page_torrentContainer__61xiZ",torrentContainerSelected:"page_torrentContainerSelected__D02fu",deleteModalBody:"page_deleteModalBody__bzhao",deleteFilesCheckbox:"page_deleteFilesCheckbox__pDrDv",torrent:"page_torrent__dlw1s",torrentDivider:"page_torrentDivider__MuLhJ",torrentIcon:"page_torrentIcon__FRbvk",torrentInfo:"page_torrentInfo__vjazF",progress:"page_progress__QfnYK",title:"page_title__po7na",progressDetails:"page_progressDetails__45reU",actionBar:"page_actionBar__6zXwy",actionButtons:"page_actionButtons__aac_D",actionSearch:"page_actionSearch__WQcJb"}}},function(e){e.O(0,[676,985,879,734,971,69,744],function(){return e(e.s=6220)}),_N_E=e.O()}]);